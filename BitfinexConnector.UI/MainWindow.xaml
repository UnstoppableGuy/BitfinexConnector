<Window x:Class="BitfinexConnector.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Bitfinex Real-time Data Monitor" Height="900" Width="1400"
WindowStartupLocation="CenterScreen"
Background="#1E1E1E">
    <Window.Resources>
        <!-- Modern Button Style -->
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#3A3A3A"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                            CornerRadius="6"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            BorderBrush="{TemplateBinding BorderBrush}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#4A4A4A"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#2A2A2A"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Connect Button Style -->
        <Style x:Key="ConnectButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="#27AE60"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2ECC71"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Disconnect Button Style -->
        <Style x:Key="DisconnectButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="#E74C3C"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#C0392B"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Modern ComboBox Style -->
        <Style x:Key="ModernComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="#3A3A3A"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#555"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Height" Value="32"/>
        </Style>

        <!-- Modern DataGrid Style -->
        <Style x:Key="ModernDataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="#2A2A2A"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#404040"/>
            <Setter Property="VerticalGridLinesBrush" Value="#404040"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="CanUserReorderColumns" Value="False"/>
            <Setter Property="CanUserResizeRows" Value="False"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="AlternatingRowBackground" Value="#252525"/>
            <Setter Property="RowBackground" Value="#2A2A2A"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <!-- DataGrid Header Style -->
        <Style x:Key="DataGridHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#404040"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="BorderBrush" Value="#555"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
        </Style>

        <!-- TabItem Style -->
        <Style x:Key="ModernTabItemStyle" TargetType="TabItem">
            <Setter Property="Background" Value="#3A3A3A"/>
            <Setter Property="Foreground" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border Background="{TemplateBinding Background}"
                            BorderThickness="0,0,0,2"
                            BorderBrush="Transparent"
                            Margin="2,0">
                            <ContentPresenter x:Name="ContentSite"
                                        VerticalAlignment="Center"
                                        HorizontalAlignment="Center"
                                        ContentSource="Header"
                                        Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#1E1E1E"/>
                                <Setter Property="Foreground" Value="White"/>
                                <Setter TargetName="ContentSite" Property="TextElement.Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#4A4A4A"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- GroupBox Style -->
        <Style x:Key="ModernGroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#404040"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GroupBox">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" 
                                Background="#404040" 
                                CornerRadius="4,4,0,0"
                                Padding="12,6">
                                <ContentPresenter ContentSource="Header"
                                            TextElement.FontWeight="Bold"
                                            TextElement.FontSize="14"/>
                            </Border>
                            <Border Grid.Row="1"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="0,0,4,4"
                                Padding="{TemplateBinding Padding}">
                                <ContentPresenter/>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Enhanced Control Panel -->
        <Border Grid.Row="0" Background="#2A2A2A" Padding="16" BorderBrush="#404040" BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Controls Section -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="Trading Pair:" Foreground="#CCCCCC" VerticalAlignment="Center" 
                           Margin="0,0,8,0" FontWeight="Medium"/>
                    <ComboBox x:Name="PairComboBox" Width="140" SelectedIndex="0" 
                          Style="{StaticResource ModernComboBoxStyle}" Margin="0,0,16,0">
                        <ComboBoxItem>tBTCUSD</ComboBoxItem>
                        <ComboBoxItem>tETHUSD</ComboBoxItem>
                        <ComboBoxItem>tXRPUSD</ComboBoxItem>
                        <ComboBoxItem>tLTCUSD</ComboBoxItem>
                    </ComboBox>

                    <Button x:Name="ConnectButton" Content="🔗 Connect" 
                        Style="{StaticResource ConnectButtonStyle}" Click="ConnectButton_Click"/>
                    <Button x:Name="DisconnectButton" Content="⛔ Disconnect" 
                        Style="{StaticResource DisconnectButtonStyle}" Click="DisconnectButton_Click"
                        IsEnabled="False"/>
                </StackPanel>

                <!-- Status Section -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <Ellipse x:Name="StatusIndicator" Width="12" Height="12" Fill="#95A5A6" Margin="0,0,8,0"/>
                    <TextBlock x:Name="StatusText" Text="Disconnected" Foreground="#CCCCCC" 
                           FontWeight="Medium" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Enhanced Main Content -->
        <TabControl Grid.Row="1" Background="#1E1E1E" BorderThickness="0">
            <TabControl.Resources>
                <Style TargetType="TabItem" BasedOn="{StaticResource ModernTabItemStyle}"/>
            </TabControl.Resources>

            <!-- Enhanced Trades Tab -->
            <TabItem Header="📊 Real-time Trades">
                <Grid Margin="8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="8"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Buy Trades -->
                    <GroupBox Grid.Column="0" Header="🟢 Buy Orders" Style="{StaticResource ModernGroupBoxStyle}">
                        <DataGrid x:Name="BuyTradesGrid" Style="{StaticResource ModernDataGridStyle}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Time" Binding="{Binding TimeString}" Width="120">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                            <Setter Property="Background" Value="#27AE60"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Price ($)" Binding="{Binding Price, StringFormat=N2}" Width="120">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                            <Setter Property="Background" Value="#27AE60"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="Foreground" Value="#2ECC71"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat=N6}" Width="120">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                            <Setter Property="Background" Value="#27AE60"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </GroupBox>

                    <!-- Sell Trades -->
                    <GroupBox Grid.Column="2" Header="🔴 Sell Orders" Style="{StaticResource ModernGroupBoxStyle}">
                        <DataGrid x:Name="SellTradesGrid" Style="{StaticResource ModernDataGridStyle}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Time" Binding="{Binding TimeString}" Width="120">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                            <Setter Property="Background" Value="#E74C3C"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Price ($)" Binding="{Binding Price, StringFormat=N2}" Width="120">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                            <Setter Property="Background" Value="#E74C3C"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="Foreground" Value="#E74C3C"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat=N6}" Width="120">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                            <Setter Property="Background" Value="#E74C3C"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Enhanced Candles Tab -->
            <TabItem Header="📈 Candlestick Data">
                <GroupBox Header="📊 1-Minute OHLCV Candles" Style="{StaticResource ModernGroupBoxStyle}">
                    <DataGrid x:Name="CandlesGrid" Style="{StaticResource ModernDataGridStyle}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Time" Binding="{Binding TimeString}" Width="140">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                        <Setter Property="Background" Value="#3498DB"/>
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Open ($)" Binding="{Binding Open, StringFormat=N2}" Width="100">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                        <Setter Property="Background" Value="#3498DB"/>
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontFamily" Value="Consolas"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="High ($)" Binding="{Binding High, StringFormat=N2}" Width="100">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                        <Setter Property="Background" Value="#3498DB"/>
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontFamily" Value="Consolas"/>
                                        <Setter Property="Foreground" Value="#2ECC71"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Low ($)" Binding="{Binding Low, StringFormat=N2}" Width="100">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                        <Setter Property="Background" Value="#3498DB"/>
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontFamily" Value="Consolas"/>
                                        <Setter Property="Foreground" Value="#E74C3C"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Close ($)" Binding="{Binding Close, StringFormat=N2}" Width="100">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                        <Setter Property="Background" Value="#3498DB"/>
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontFamily" Value="Consolas"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Volume" Binding="{Binding Volume, StringFormat=N2}" Width="120">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                        <Setter Property="Background" Value="#3498DB"/>
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontFamily" Value="Consolas"/>
                                        <Setter Property="Foreground" Value="#F39C12"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
            </TabItem>

            <!-- Enhanced Portfolio Tab -->
            <TabItem Header="💰 Portfolio">
                <Grid Margin="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="💼 Current Portfolio Holdings" 
                           FontSize="20" FontWeight="Bold" Foreground="White" 
                           Margin="0,0,0,8"/>

                    <Border Grid.Row="1" Background="#2A2A2A" CornerRadius="6" Padding="16" Margin="0,0,0,16">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Total Portfolio Value" Foreground="#CCCCCC" FontSize="12"/>
                                <TextBlock x:Name="TotalValueText" Text="$0.00" Foreground="#2ECC71" 
                                       FontSize="24" FontWeight="Bold"/>
                            </StackPanel>

                            <StackPanel Grid.Column="1">
                                <TextBlock Text="Number of Assets" Foreground="#CCCCCC" FontSize="12"/>
                                <TextBlock x:Name="AssetCountText" Text="4" Foreground="#3498DB" 
                                       FontSize="24" FontWeight="Bold"/>
                            </StackPanel>

                            <StackPanel Grid.Column="2">
                                <TextBlock Text="Last Updated" Foreground="#CCCCCC" FontSize="12"/>
                                <TextBlock x:Name="LastUpdatedText" Text="Never" Foreground="#F39C12" 
                                       FontSize="14" FontWeight="Medium"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <DataGrid Grid.Row="2" x:Name="PortfolioGrid" Style="{StaticResource ModernDataGridStyle}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Currency" Binding="{Binding Currency}" Width="120">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                        <Setter Property="Background" Value="#8E44AD"/>
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="FontFamily" Value="Consolas"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat=N8}" Width="200">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                        <Setter Property="Background" Value="#8E44AD"/>
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontFamily" Value="Consolas"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="USD Value" Binding="{Binding ValueInUSD, StringFormat=C}" Width="150">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                        <Setter Property="Background" Value="#8E44AD"/>
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontFamily" Value="Consolas"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#2ECC71"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Percentage" Binding="{Binding PercentageOfTotal, StringFormat=P1}" Width="120">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}">
                                        <Setter Property="Background" Value="#8E44AD"/>
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontFamily" Value="Consolas"/>
                                        <Setter Property="Foreground" Value="#F39C12"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <Button Grid.Row="3" x:Name="RefreshPortfolioButton" Content="🔄 Refresh Portfolio" 
                        Style="{StaticResource ModernButtonStyle}" Background="#8E44AD"
                        HorizontalAlignment="Left" Margin="0,16,0,0" Click="RefreshPortfolioButton_Click"/>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Enhanced Status Bar -->
        <Border Grid.Row="2" Background="#2A2A2A" BorderBrush="#404040" BorderThickness="0,1,0,0">
            <Grid Margin="16,8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="🔗" FontSize="14" Margin="0,0,4,0"/>
                    <TextBlock x:Name="ConnectionStatusText" Text="Ready" Foreground="#CCCCCC" FontWeight="Medium"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="16,0">
                    <TextBlock Text="🕒" FontSize="14" Margin="0,0,4,0"/>
                    <TextBlock x:Name="LastUpdateText" Text="Last Update: Never" Foreground="#CCCCCC"/>
                </StackPanel>

                <StackPanel Grid.Column="3" Orientation="Horizontal">
                    <TextBlock Text="📊" FontSize="14" Margin="0,0,4,0"/>
                    <TextBlock x:Name="DataCountText" Text="0 trades, 0 candles" Foreground="#CCCCCC"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
